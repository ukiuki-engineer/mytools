# excelgrep

- excel ファイルの全文検索を行うシェルスクリプト
- bash が動く環境であれば使用可能

## インストール方法

1. PATH が通っているディレクトリに配置するか、配置したディレクトリの PATH を通す

```
例)
・~/binというディレクトリを作成し、本スクリプトを配置
・~/binのPATHを通す
```

2. 実行権限を与える

```bash
chmod +x excelgrep
```

## 使用方法

基本的に grep コマンドと同じような使い方ができる。

- カレントディレクトリ内のエクセルファイルに対して全文検索を行う

```bash
excelgrep '検索文字列' *.xlsx
```

- カレントディレクトリ以下の全てのディレクトリ内のエクセルファイルに対して全文検索を行う

```bash
find . -type f | grep -E 'xlsx$' | xargs -I{} excelgrep '検索文字列' {}
```

## オプション

基本的に grep コマンドと同じオプションが使える

- 大文字小文字を区別しない
  →`-i`

- 正規表現
  →`-E`

```
例)大文字小文字を区別しないor検索
excelgrep -iE '検索文字列1|検索文字列2' *.xlsx
```

## TODO

- 見なくて良い xml ファイルとかもありそうなので、エクセルファイルの構造を調べてその辺は無駄を省きたい。
- 流石にもう少し整理したい。パイプ使いすぎ。
- Office 全般に使えるように拡張したい。
